<!DOCTYPE html>
<html lang="en">

<head>
    <meta name='author' content="Andy G. Vélez">
    <title>MLB PR</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial scale=1" margin=auto>
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/modules/series-label.js"></script>
    <script src="https://code.highcharts.com/modules/exporting.js"></script>
    <script src="https://code.highcharts.com/modules/export-data.js"></script>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css"
        integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">
</head>

<body>

<style>
#result {
    text-align: right;
    color: gray;
    min-height: 2em;
}
#table-sparkline {
    margin: 0 auto;
    border-collapse: collapse;
}
th {
    font-weight: bold;
    text-align: center;
}
td, th {
    padding: 5px;
    border-bottom: 1px solid silver;
    height: 20px;
    text-align: center;
}

thead th {
    border-top: 2px solid gray;
    border-bottom: 2px solid gray;
}
.highcharts-tooltip>span {
    background: white;
    border: 1px solid silver;
    border-radius: 3px;
    box-shadow: 1px 1px 2px #888;
    padding: 8px;
}
</style>

<div id="result"></div>
<h2 style="text-align:center">Gráfica 1: Average por Temporada</h2>
<table id="table-sparkline">
    <thead>
        <tr>
            <th>Jugador</th>
            <th>Promedio de Bateo por Vida</th>
            <th>Promedio de Bateo (AVG) por Intervalo de Edad<p style="position:relative; left:17%; text-align:right; display:inline-block">Valor Crítico de Referencia</p></th>
        </tr>
    </thead>
    <tbody id="tbody-sparkline">
        <tr>
            <th>Ty Cobb</th>
            <td>366</td>
            <td data-sparkline="240, 316, 350, 324, 377, 383, 420, null, 409, 390, 368, 369, 371, 383, 382, 384, 334, 389, null, 401, 340, 338, 378, 339, 357, 323, 366, null, null, null, null"/>
        </tr>
        <tr>
            <th>Roberto Clemente</th>
            <td>317</td>
            <td data-sparkline="null, null, 255, 311, 253, 289, 296, null, 314, 351, 312, 320, 339, 329, 317, 357, 291, 345, null, 352, 341, 312, null, null, null, null, null, null, null, null"/>
        </tr>
        <tr>
            <th>Edgar Martínez</th>
            <td>312</td>
            <td data-sparkline="null, null, null, null, null, null, 372, null, 281, 240, 302, 307, 343, 237, 285, 356, 327, 330, null, 322, 337, 324, 306, 277, 294, 263, null, null, null, null, null"/>
        </tr>
        <tr>
            <th>Roberto Alomar</th>
            <td>300</td>
            <td data-sparkline="null, null, 266, 295, 287, 295, 310, null, 326, 306, 300, 328, 333, 282, 323, 310, 336, 266, null, 258, 263, null, null, null, null, null, null, null, null, null, null"/>
        </tr>
        <tr>
            <th>Orlando Cepeda</th>
            <td>297</td>
            <td data-sparkline="null, 312, 317, 297, 311, 306, null, 316, 304, 176, 301, 325, 248, 257, 305, 276, 287, null, 289, 215, null, null, null, null, null, null, null, null, null, null"/>
        </tr>
        <tr>
            <th>Iván Rodríguez</th>
            <td>296</td>
            <td data-sparkline="null, 264, 260, 273, 298, 303, 300, null, 313, 321, 332, 347, 308, 314, 297, 334, 276, 300, null 281, 276, 249, 266, 218 null, null, null, null, null, null, null"/>
        </tr>
        <tr>
            <th>Juan González</th>
            <td>295</td>
            <td data-sparkline="null, 150, 289, 264, 260, 310, 275, null, 295, 314, 296, 318, 326, 289, 325, 282, 294, 276, null, null, null, null, null, null, null, null, null, null, null, null"/>
        </tr>
        <tr>
            <th>Carlos Delgado</th>
            <td>280</td>
            <td data-sparkline="null, null, null, null, 215, 165, 270, null, 262, 292, 272, 344, 279, 277, 302, 269, 301, 265, null 258, 271, 298, null, null, null, null, null, null, null, null, null"/>
        </tr>
        <tr>
            <th>Carlos Beltrán</th>
            <td>279</td>
            <td data-sparkline="null, null, null, 276, 293, 247, 306, null, 273, 307, 267, 266, 275, 276, 284, 325, 255, 300, null, 269, 296, 233, 276, 295, 231, null, null, null, null, null, null"/>
        </tr>
    </tbody>
</table>

<script>
    /**
 * Create a constructor for sparklines that takes some sensible defaults and merges in the individual
 * chart options. This function is also available from the jQuery plugin as $(element).highcharts('SparkLine').
 */
Highcharts.SparkLine = function (a, b, c) {
    var hasRenderToArg = typeof a === 'string' || a.nodeName,
        options = arguments[hasRenderToArg ? 1 : 0],
        defaultOptions = {
            chart: {
                renderTo: (options.chart && options.chart.renderTo) || this,
                backgroundColor: null,
                borderWidth: 0,
                type: 'areaspline',
                margin: [0, 0, 20, 0],
                width: 800,
                height: 90,
                zoomType:'x',
                style: {
                    overflow: 'visible'
                },

                // small optimalization, saves 1-2 ms each sparkline
                skipClone: true
            },
            title: {
                text: ' '
            },
            credits: {
                enabled: false
            },
            exporting: {
                enabled:false
            },
            xAxis: {
                categories: [' ','18','19','20','21','22','23','24',' ','25','26','27','28',
                    '29', '30','31','32','33','34', ' ','35','36','37','38','39','40','41','42','43','44','45','46'],
                labels: {
                    formatter: function () {
                if (this.value == '24' || this.value == '25' || this.value == '34' || this.value == '35') {
                    return this.value;
                }
            }
                }
            },
            yAxis: {
                endOnTick: false,
                startOnTick: false,
                labels: {
                    enabled: false
                },
                title: {
                    text: null
                },
                tickPositions: [0],
                max:450,
                min:100,
                plotLines: [{
                    value: 300,
                    color: '#2a8e40',
                    dashStyle: 'shortdash',
                    width: 1.5,
                    label: {
                        text:"300 AVG",
                        align:"right",
                        x:-20
                    }
                }]

            },
            legend: {
                enabled: false
            },
            tooltip: {
                hideDelay: 0,
                outside: true,
                shared: true
            },
            plotOptions: {
                series: {
                    showInLegend:false,
                    animation: 5000,
                    lineWidth: 1.2,
                    shadow: false,
                    states: {
                        hover: {
                            lineWidth: 1
                        }
                    },
                    marker: {
                        radius: 1,
                        states: {
                            hover: {
                                radius: 2
                            }
                        }
                    },
                    fillOpacity: 0.25
                },
            }
        };

        options = Highcharts.merge(defaultOptions, options);

    return hasRenderToArg ?
        new Highcharts.Chart(a, options, c) :
        new Highcharts.Chart(options, b);
};

var start = +new Date(),
    $tds = $('td[data-sparkline]'),
    fullLen = $tds.length,
    n = 0;

// Creating 153 sparkline charts is quite fast in modern browsers, but IE8 and mobile
// can take some seconds, so we split the input into chunks and apply them in timeouts
// in order avoid locking up the browser process and allow interaction.
function doChunk() {
    var time = +new Date(),
        i,
        len = $tds.length,
        $td,
        stringdata,
        arr,
        data,
        chart;

    for (i = 0; i < len; i += 1) {
        $td = $($tds[i]);
        stringdata = $td.data('sparkline');
        arr = stringdata.split('; ');
        data = $.map(arr[0].split(', '), parseFloat);
        chart = {};

        if (arr[1]) {
            chart.type = arr[1];
        }
        $td.highcharts('SparkLine', {
            series: [{
                name: ' ',
                data: data,
                pointStart: 1,
                color: '#2a8e40',
                animation: {
                    enabled: true,
                    duration: 10000,
                    easing: 'linear'
                },
            }],
            tooltip: {
                headerFormat: '<span>' + $td.parent().find('th').html() + '<br>Edad: {point.x}<br></span>',
                pointFormat: '<b>Valor: {point.y}</b>'
            },
            chart: chart,
        });

n += 1;

// If the process takes too much time, run a timeout to allow interaction with the browser
if (new Date() - time > 500) {
    $tds.splice(0, i + 1);
    setTimeout(doChunk, 0);
    break;
}

}
}
doChunk();

</script>

</body>
</html>